---
title: "Wikipedia Search 🔍"
description: "Searches Wikipedia for the given query"
input:
  - name: query
    type: string
    description: "The search query"
---

<!-- This tool queries Wikipedia's API to search articles and return relevant extracts -->

Searching Wikipedia for: {% $frontmatter.input.query %}

```js {#output}
// Read the term generated by the language model
const input = {{ $frontmatter.input.query }}.trim().replace(/^"+|"+$/g, '');
console.log("Searching for the term", input);

// Query Wikipedia for relevant pages
const maxResults = 3;
const searchTerm = encodeURIComponent(input.trim());
const url = "https://en.wikipedia.org/w/api.php?format=json&action=query&list=search&srsearch=" + searchTerm + "&srlimit=" + maxResults + "&utf8=&origin=*";
const response = await fetch(url);
const data = await response.json();

const fetchExtract = async (title) => {
  console.log("Retrieving", title);
  const extractUrl = "https://en.wikipedia.org/w/api.php?format=json&action=query&prop=extracts&exintro&explaintext&titles=" + encodeURIComponent(title) + "&redirects=1&origin=*";
  const extractResponse = await fetch(extractUrl);
  const extractData = await extractResponse.json();
  const pageId = Object.keys(extractData.query.pages)[0];
  const extract = extractData.query.pages[pageId].extract;
  return [title, extract];
}

if (data.query.search.length > 0) {
  console.log("Got some results extracting top", data.query.search.length);
  const extracts = await Promise.all(data.query.search.map(result => fetchExtract(result.title)));
  return extracts.map(([title, extract]) => `${title} \n${extract}`).join("\n\n");
} else {
  return "No results found.";
}
```

{% $output.result %}